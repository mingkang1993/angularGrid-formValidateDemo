var app=angular.module("app",["ui.router","ngSanitize","angularLazyImg","grid","datetimepicker","ngTagsInput","slideImg","angular-carousel","china-area-selector","angucomplete","ngDialog","hipacPage","cz-mobile"],["$compileProvider","$locationProvider",function(e,t){t.html5Mode(!0).hashPrefix("!"),e.aHrefSanitizationWhitelist(/^\s*((https?|ftp|tel|sms|mailto|file|javascript|chrome-extension):)|#/)}]);app.controller("mainController",["$scope","$rootScope",function(e,t){t.loading=!1,t.prefix="/seller/"}]),app.directive("compile",["$timeout","$compile",function(e,t){return{restrict:"EA",scope:{template:"="},link:function(a,i,o){var s;e(function(){s=a.$watch("template",function(e){if(angular.isDefined(e)){var o=t(e)(a);i.html(""),i.append(o)}}),a.$on("$destroy",function(){s()})},0)}}}]).directive("print",["$timeout","$compile",function(e,t){return{restrict:"EA",scope:{printBefore:"="},link:function(t,a,i){e(function(){var e=$("#"+i.print);a.on("click",function(){void 0!=t.printBefore?t.printBefore&&e.jqprint():e.jqprint()}),t.$on("$destroy",function(){a.off("click")})},0)}}}]).directive("dialogClose",["$timeout",function(e){return{restrict:"EA",link:function(t,a,i){e(function(){a.on("click",function(){t.closeThisDialog()}),t.$on("$destroy",function(){a.off("click")})},0)}}}]).directive("back",["$timeout",function(e){return{restrict:"EA",link:function(t,a,i){e(function(){a.on("click",function(){window.history.go(-1)}),t.$on("$destroy",function(){a.off("click")})},0)}}}]),app.factory("confirmFactory",["$rootScope","$http","ngDialog",function(e,t,a){function i(e){var t='<h2 class="ngdialog-title">'+e.title+'</h2><div class="ngdialog-main">'+e.text+"</div>";return e.showBtn&&(t+='<div class="ngdialog-buttons pb-10 pr-10">                            <button type="button" class="ngdialog-button ngdialog-button-secondary" ng-click="closeThisDialog(0)">取消</button>                            <button type="button" class="ngdialog-button btn" ng-click="closeThisDialog(1)">确定</button>                      </div>'),t}return function(e){var t={title:"确定取消",text:"确定要取消吗?",width:400,plain:!0,showBtn:!0,ok:function(){}};angular.extend(t,e),t.template=i(t),t.preCloseCallback=function(e){1===e&&t.ok.apply(this,arguments)},a.openConfirm(t)}}]),app.filter("unit",function(){return function(e){var e=e?"¥"+e/100:"暂无";return e}}),app.factory("authHttpResponseInterceptor",["$q","$location","$rootScope","$timeout","$injector",function(e,t,a,i,o){function s(e){var t=o.get("messageFactory");t({text:e||"请求出错"})}function l(){i.cancel(r),c=!0,a.loading=!1}var r,c=!1;return{request:function(e){var e=e||{};return e.timeout=1e4,e.load=e.load||!0,c=!1,e.load&&(i.cancel(r),r=i(function(){c||(a.loading=!0)},500)),e},response:function(t){return l(),"object"!=typeof t.data||200==t.status&&t.data.success?t||e.when(t):(s(t.data.message),e.reject(t))},responseError:function(t){return l(),s("服务器出错请求出错"),e.reject(t)}}}]),function(e){var t=[{name:"order/orderList",url:"/order/orderList",templateUrl:"/view/order/orderList/orderListBase.html",controller:"orderListBaseCrt"},{name:"order/orderList.type",url:"/list.do?{type:all||bPaid||cAccept||dDelivered||eComplete}",uiView:"orderListType",templateUrl:"/view/order/orderList/orderList.html",controller:"orderListCrt",pageRp:1},{name:"goods/supplyList",url:"/goods/supplyList.do",templateUrl:"/view/goods/supply/supplyList.html",controller:"supplySupplyListCrt",pageRp:2},{name:"goods/supplyDetailEdit",url:"/goods/supplyDetailEdit.do?:type&:id",templateUrl:"/view/goods/supply/supplyDetailEdit.html",controller:"supplyDetailEditCrt",pageRp:3},{name:"goods/supplyDetailInfo",url:"/goods/supplyDetailInfo.do?:id",templateUrl:"/view/goods/supply/supplyDetailInfo.html",controller:"supplyDetailInfoCrt",pageRp:4},{name:"goods/freightTemplateList",url:"/goods/freightTemplateList.do",templateUrl:"/view/goods/freightTemplate/freightTemplateList.html",controller:"freightTemplateListCrt",pageRp:5},{name:"goods/freightTemplateEdit",url:"/goods/freightTemplateEdit.do?:{type || id}",templateUrl:"/view/goods/freightTemplate/freightTemplateEdit.html",controller:"freightTemplateEditCrt",pageRp:6},{name:"goods/sinceList",url:"/goods/sinceList.do",templateUrl:"/view/goods/since/sinceList.html",controller:"sinceListCrt",pageRp:7},{name:"demo",url:"/demo",templateUrl:"/view/demo.html",controller:"demoCtr"}];e.config(["$stateProvider","$urlRouterProvider","$httpProvider","lazyImgConfigProvider","ngDialogProvider",function(e,a,i,o,s){o.setOptions({startClass:"startImg",successClass:"loadSuccessImg"}),i.interceptors.push("authHttpResponseInterceptor"),i.defaults.withCredentials=!0,i.defaults.headers.put["Content-Type"]="application/x-www-form-urlencoded; charset=UTF-8",i.defaults.headers.post["Content-Type"]="application/x-www-form-urlencoded; charset=UTF-8",i.defaults.headers.common.Accept="application/json, text/javascript, */*; q=0.01",i.defaults.headers.common["Accept-Language"]="zh-CN,zh; q=0.08",i.defaults.headers.common.PAJAX="true",i.defaults.transformRequest=[function(e){return angular.isObject(e)&&"[object File]"!==String(e)?angular.param(e):e}],t.forEach(function(t){var a={name:t.name,url:t.url,views:{},pageRp:t.pageRp};a.views[t.uiView||"appState"]={templateUrl:t.templateUrl,controller:t.controller},e.state(a)}),a.otherwise("order/orderList/list.do?type=all")}])}(app),app.run(["$rootScope",function(e){e.$on("$stateChangeStart",function(e,t,a){}),e.$on("$stateChangeSuccess",function(t,a,i){a.pageRp&&(e.pageRp=a.pageRp)}),e.$on("$stateNotFound",function(e,t,a,i){}),e.$on("$stateChangeError",function(e,t,a,i,o,s){})}]),app.controller("selectAreaAllCtr",["$scope","$rootScope","selectAreaAllService","selectDatas",function(e,t,a,i){function o(e,t,a){for(var i=0;i<=e.length-1;i++){var o={id:e[i].id,parentId:e[i].parentId,childList:[]};e[i].provinceAreaDTOList?arguments.callee(e[i].provinceAreaDTOList,t,a):(e[i].isSelect&&a.push(e[i].areaName),(e[i].isSelect||e[i].isChildSelect)&&t.push(o),e[i].childList&&e[i].isChildSelect&&!e[i].isSelect&&arguments.callee(e[i].childList,o.childList,a))}return t}function s(e){var t=0;return angular.forEach(e,function(e){e.isSelect&&t++}),t}function l(e,t){t?e.isChildSelect=!0:e.isChildSelect=!1}function r(e,t){angular.forEach(e,function(e){t?(e.isSelect=!0,e.selectNum=0):e.isSelect=!1,e.childList&&r(e.childList,t)})}function c(e,t,a,i){var o=t.provinceAreaDTOList||t.childList,c=s(o);if(e.isSelect?c==o.length&&(t.isSelect=!0,e.selectNum=0):(t.isSelect=!1,e.selectNum=0),1==o.length){var a=s(o[0].childList);l(t,a)}else l(t,c||a);return i||r(e.childList,e.isSelect),t.selectNum=c,c}function n(){e.closeThisDialog()}function p(e){return angular.element(document.getElementById("provinceData"+e)).scope().provinceItem}e.areaData=[],e.areaSelectData={areaSelectIndex:0,countySelectIndex:-1,areaData:[]},e.provinceClick=function(t,a,i){e.areaSelectData.areaSelectIndex=a,e.areaSelectData.areaData=[],angular.forEach(t.childList,function(t){e.areaSelectData.areaData.push(t)})},e.provinceSelectAll=function(e,t){c(e,t),l(e,e.isSelect)},e.areaSelectAll=function(e,t){var a=p(e.parentId);c(e,t),c(e,a)},e.selectAll=function(e,t){r(e,t)},e.countySelect=function(e,t,a){var i=p(t.parentId);c(e,t),c(e,i,t.selectNum),c(e,a,i.selectNum)},e.countyToggle=function(t){return e.areaSelectData.countySelectIndex==t?void(e.areaSelectData.countySelectIndex=-1):void(e.areaSelectData.countySelectIndex=t)},e.submit=function(){var t=[],a=[];return o(e.areaData,t,a),i.selectCallback?void i.selectCallback(a,t,n):void n()},a.area(function(t){function a(e,t,a){for(var i=0;i<e.length;i++)e[i].id==t&&(e[i].isSelect=!0,r(e[i].childList,!0)),a&&!a.isSelect&&c(e[i],a,0,!0),e[i].provinceAreaDTOList&&arguments.callee(e[i].provinceAreaDTOList,t,e[i]),e[i].childList&&e[i].childList.length&&arguments.callee(e[i].childList,t,e[i])}e.areaData=t.data,function(t){for(var i=0;i<t.length;i++)t[i].childList&&t[i].childList.length?arguments.callee(t[i].childList):a(e.areaData,t[i].id)}(i.selectData||[])})}]),app.service("selectAreaAllService",["$http",function(e){this.area=function(t){e.get("/seller/area/queryAllRegionList.json").success(t)}}]),app.controller("upPassCtr",["$scope","$timeout","upPassService","messageFactory",function(e,t,a,i){var o=!1;e.getData={},e.submit=function(){o||a.upPass(e.getData,function(a){e.closeThisDialog(),i({text:"修改密码成功"}),o=!0,t(function(){location.href=a.data},2e3)})}}]),app.service("upPassService",["$http",function(e){this.upPass=function(t,a){e.post("/seller/user/updatePassword.json ",t).success(a)}}]),app.controller("freightTemplateEditCrt",["$scope","$rootScope","$stateParams","ngDialog","messageFactory","freightTemplateFactory","freightTemplateService",function(e,t,a,i,o,s,l){var r={templateId:a.id},c={model1:{pieceworkWay:1,data:[]},model2:{pieceworkWay:1,data:[]},model3:{pieceworkWay:1,data:[]},model4:{pieceworkWay:1,data:[]}};e.addEditData={},e.pricingType=s.pricingType,e.tabData=s.editTab,e.tabToggle=function(t){e.selectId=t,e.logisticCarryStrItem=c["model"+e.selectId]},e.addLogisticInit=function(t,a){t.pieceworkWay=a,t.logisticType=e.selectId},e.addRow=function(){return e.logisticCarryStrItem.data.length<20?(e.logisticCarryStrItem.data.push({}),!1):void o({text:"最多加20条"})},e.deleteRow=function(t){e.logisticCarryStrItem.data.splice(t,1)},e.selectAreaDialog=function(e){i.open({template:"/view/common/selectAreaAll.html",controller:"selectAreaAllCtr",width:750,resolve:{selectDatas:function(){return{selectName:e.receiveAreaNames,selectData:e.receiveAreaRelation,selectCallback:function(t,a,i){e.receiveAreaNames=t.join("、"),e.receiveAreaRelation=a,i()}}}}})},e.submit=function(){var a=angular.copy(e.addEditData);a.logisticCarryFormList=[];for(var i in c)angular.forEach(c[i].data,function(e){e.pieceworkWay=c["model"+e.logisticType].pieceworkWay,a.logisticCarryFormList.push(e)});l.addTemplate(a,function(){var e="";e=r.templateId?"修改成功":"新增成功",o({text:e}),location.href=t.prefix+"goods/freightTemplateList.do"})},r.templateId?l.getTemplate(r,function(t){e.addEditData=t.data,angular.forEach(e.addEditData.logisticCarryFormList,function(e){c["model"+e.logisticType].data.push(e),c["model"+e.logisticType].pieceworkWay=e.pieceworkWay}),e.tabToggle(t.data.logisticType.split(",")[0])}):e.tabToggle(e.tabData[0].id)}]),app.controller("freightTemplateListCrt",["$scope","confirmFactory","messageFactory","freightTemplateFactory","freightTemplateService",function(e,t,a,i,o){e.getData={},e.gridOptions={url:"/seller/logistic/queryTemplateList.json",columnDefs:i.listHeader,params:e.getData},e.deleteItem=function(i,s){t({title:"确认操作",text:"确认操作吗？",ok:function(){o.listDeleteItem({templateId:i},function(){e.gridOptions.data.splice(s,1),a({text:"删除成功！"})})}})},e.search=function(){e.gridOptions.search()}}]),app.factory("freightTemplateFactory",function(){return{pricingType:[{value:1,name:"按重量",key:"weight"},{value:2,name:"按体积",key:"volume"},{value:3,name:"按件数",key:"num"}],listHeader:[{displayName:"模板名称",field:"templateName",width:"20%"},{displayName:"类型",field:"logisticTypeName",width:"20%"},{displayName:"模板描述",field:"templateDesc",width:"20%"},{displayName:"创建时间",field:"createTime",width:"20%"},{displayName:"操作",width:"20%",cellTemplate:'<div><a class="mr-5" href="{{prefix}}goods/freightTemplateEdit.do?id={{row.id}}">修改</a><a ng-click="evt.entity.deleteItem(row.id,$index)">删除</a></div>'}],editTab:[{id:1,name:"快递"},{id:2,name:"物流"},{id:3,name:"物流自提"},{id:4,name:"供应商配送"}]}}),app.service("freightTemplateService",["$http",function(e){this.addLogisticTemplate=function(t,a){e.post("/seller/logistic/logistictemplate/insert.json",t).success(a)},this.addTemplate=function(t,a){e.post("/seller/logistic/insertOrUpdateTemplate.json",t).success(a)},this.listDeleteItem=function(t,a){e.post("/seller/logistic/deleteTemplate.json",t).success(a)},this.getTemplate=function(t,a){e.post("/seller/logistic/getTemplate.json",t).success(a)}}]),app.controller("sinceAddEditSinceDialog",["$scope","sinceService","getData",function(e,t,a){var i="edit"==a.type;e.getData={},e.selectAddressData={area:{},city:{},province:{}},i&&(e.selectAddressData={area:{id:a.data.areaId,areaName:a.data.areaName},city:{id:a.data.cityAreaId,areaName:a.data.cityAreaName},province:{id:a.data.provinceAreaId,areaName:a.data.provinceAreaName}},angular.extend(e.getData,a.data)),e.submit=function(){e.getData.cityAreaId=e.selectAddressData.city.id,e.getData.areaId=e.selectAddressData.area.id,e.getData.provinceAreaId=e.selectAddressData.province.id,t.addEdit(e.getData,function(t){e.closeThisDialog(),location.reload()})}}]),app.controller("sinceListCrt",["$scope","ngDialog","messageFactory","sinceCacheFactory","confirmFactory","sinceService",function(e,t,a,i,o,s){e.selectAddressData={area:{},city:{},province:{}},e.getData={},e.gridOptions={url:"/seller/pickAddress/querySupplyPickAddressList.json",columnDefs:i.sinceTableHeader,params:e.getData},e.listStateData=i.listStateData,e.haltOpen=function(e){var t={id:e.id};"0"===e.isUse?s.usePickAddress(t,function(){e.isUse="1",a({text:"启动成功"})}):o({title:"确定停用",text:"确定要停用吗?",ok:function(){s.unUsePickAddress(t,function(){e.isUse="0",a({text:"停用成功"})})}})},e.search=function(){e.getData.cityAreaId="",e.getData.areaId="",e.getData.provinceAreaId="",e.selectAddressData.city&&(e.getData.cityAreaId=e.selectAddressData.city.id),e.selectAddressData.area&&(e.getData.areaId=e.selectAddressData.area.id),e.selectAddressData.province&&(e.getData.provinceAreaId=e.selectAddressData.province.id),e.gridOptions.search()},e.addEditSinceDialog=function(e,a){t.open({template:"/view/goods/since/sinceListDialog.html",controller:"sinceAddEditSinceDialog",resolve:{getData:function(){return{data:a,type:e}}}})}}]),app.factory("sinceCacheFactory",function(){return{sinceTableHeader:[{displayName:"地域",width:"16%",cellTemplate:"<div>{{row.provinceAreaName}}-{{row.cityAreaName}}-{{row.areaName}}</div>"},{displayName:"地址",field:"address",width:"15%"},{displayName:"物流公司",field:"company",width:"7%"},{displayName:"电话",field:"receivePhone",width:"14%"},{displayName:"创建时间",field:"createTime",width:"8%"},{displayName:"状态",field:"title6",width:"8%",cellTemplate:'<div>{{row.isUse === "1" ? "正常" : "停用"}}</div>'},{displayName:"操作",field:"title9",width:"9%",cellTemplate:'<div class="operation"><a ng-click="evt.entity.haltOpen(row)">{{row.isUse === "0" ? "启动" : "停用"}}</a><a ng-click="evt.entity.addEditSinceDialog(\'edit\',row)">修改</a></div>'}],listStateData:[{id:1,name:"正常"},{id:0,name:"停用"}]}}),app.service("sinceService",["$http",function(e){this.addEdit=function(t,a){e.get("/seller/pickAddress/insertOrUpdatePickAddress.json",{params:t}).success(a)},this.unUsePickAddress=function(t,a){e.get("/seller/pickAddress/unUsePickAddress.json",{params:t}).success(a)},this.usePickAddress=function(t,a){e.get("/seller/pickAddress/usePickAddress.json",{params:t}).success(a)}}]),app.controller("supplyDetailEditCrt",["$scope","$rootScope","$stateParams","ngDialog","messageFactory","supplyService",function(e,t,a,i,o,s){function l(){s.listSticTemplate(function(t){e.listSticTemplateData=t.data.logisticTemplateVOList,"add"!=e.type&&e.logisticTemplateSelect()})}function r(){var t=0;return angular.forEach(e.detailData.supplyBatchVO.supplyBatchSpecVoList,function(e){e.specNumSelect&&t++}),e.selectListTemplateData&&(e.detailData.supplyBatchVO.itemVO||t)?!0:(o({text:"请选择规则跟模版信息"}),!1)}var c={batchId:a.id},n=[],p=[];e.selectListTemplateData=null,e.type=a.type,e.listSticTemplateData=[],e.offerInfo=function(){r()&&i.open({template:"/view/goods/supply/supplyOfferInfoDialog.html",controller:"supplyOfferInfoDialogCrt",resolve:{getData:function(){return{itemId:e.detailData.supplyBatchVO.itemVO.id,provinceId:e.selectListTemplateData.areaVO.provinceAreaIdList[0],supplyBatchSpecFormList:n}},viewData:function(){return{provinceList:p,goodsTitle:e.detailData.supplyBatchVO.itemVO.itemName,specName:e.detailData.supplyBatchVO.itemSpecName}}}})},e.offerRank=function(){r()&&i.open({template:"/view/goods/supply/supplyOfferRankDialog.html",controller:"supplyOfferRankDialogCrt",resolve:{getData:function(){return{itemId:e.detailData.supplyBatchVO.itemVO.id,provinceIdList:e.selectListTemplateData.areaVO.provinceAreaIdList,logisticTemplateId:e.selectListTemplateData.id,supplyBatchSpecFormList:n}},viewData:function(){return{specName:e.detailData.supplyBatchVO.itemSpecName,showCountyNames:e.selectListTemplateData.showCountyNames}}}})},e.logisticTemplateSelect=function(){e.detailData.supplyBatchVO.areaVO={},e.detailData.supplyBatchVO.logisticVO="",e.detailData.supplyBatchVO.templateName="",e.selectListTemplateData=null,angular.forEach(e.listSticTemplateData,function(t){if(t.id==e.detailData.supplyBatchVO.logisticTemplateId){if(s.queryTemplate({id:t.id},function(t){e.selectListTemplateData=t.data.logisticTemplateDTO}),!t.areaVO)return;s.queryProvince({provinceIdList:t.areaVO.provinceAreaIdList},function(a){e.selectListTemplateData=t,e.detailData.supplyBatchVO.areaVO=t.areaVO,e.detailData.supplyBatchVO.logisticVO=t.logisticType,e.detailData.supplyBatchVO.templateName=t.templateName,p=a.data.provinceVOList})}})},e.specNumSelect=function(e){angular.addEditJson({data:n,item:e,name:"id"})},e.addSupplyBatch=function(){var a=angular.extend({},e.detailData.supplyBatchVO,{areaVO:{},supplyBatchSpecVoList:n});a.areaVO.supplyAreaRelation=e.selectListTemplateData.areaVO.supplyAreaRelation,s.addSupplyBatch(a,function(){location.href=t.prefix+"goods/supplyList.do"})},e.updateSupplyBatch=function(){var a=angular.extend({},e.detailData.supplyBatchVO,{areaVO:{},supplyBatchSpecFormList:n});a.areaVO.supplyAreaRelation=e.selectListTemplateData.areaVO.supplyAreaRelation,delete a.areaVO.countyNames,delete a.supplyBatchSpecVoList,delete a.itemVO,s.updateSupplyBatch(a,function(){location.href=t.prefix+"goods/supplyList.do"})},"add"!=e.type?s.detailData(c,function(t){e.detailData=t.data,angular.forEach(e.detailData.supplyBatchVO.supplyBatchSpecVoList,function(t){t.specNumSelect=!0,e.specNumSelect(t)}),l()}):(e.shopTypeData=[],e.detailData={supplyBatchVO:{itemVO:null}},s.shopTypeData(function(t){e.shopTypeData=t.data.categoryVOList}),l(),e.addGoods=function(t,a){e.goodsInfo?(e.detailData.supplyBatchVO.itemVO=e.goodsInfo.originalObject,e.detailData.supplyBatchVO.supplyBatchSpecVoList=e.goodsInfo.originalObject.standardSpecVOList):s.queryItemByCategory({categoryId:t,itemName:a},function(t){return t.data.length?(e.detailData.supplyBatchVO.itemVO=t.data.itemVOList[0],void(e.detailData.supplyBatchVO.supplyBatchSpecVoList=t.data.itemVOList[0].standardSpecVOList)):void o({text:"该类目下没有该商品"})})})}]),app.controller("supplyDetailInfoCrt",["$scope","$stateParams","ngDialog","messageFactory","supplyService",function(e,t,a,i,o){function s(e){return e?!0:(i({text:"供货区域为空不能查看排名"}),!1)}var l={batchId:t.id};e.detailData={supplyBatchVO:{itemVO:{}}},o.detailData(l,function(t){e.detailData=t.data,o.queryProvince({provinceIdList:t.data.supplyBatchVO.areaVO.provinceAreaIdList},function(i){e.offerInfo=function(){s(t.data.supplyBatchVO.showCountyNames)&&a.open({template:"/view/goods/supply/supplyOfferInfoDialog.html",controller:"supplyOfferInfoDialogCrt",resolve:{getData:function(){return{itemId:t.data.supplyBatchVO.itemVO.id,provinceId:t.data.supplyBatchVO.areaVO.provinceAreaIdList[0],supplyBatchSpecFormList:t.data.supplyBatchVO.supplyBatchSpecVoList}},viewData:function(){return{provinceList:i.data.provinceVOList,goodsTitle:t.data.supplyBatchVO.itemVO.itemName,specName:t.data.supplyBatchVO.itemSpecName}}}})},e.offerRank=function(){s(t.data.supplyBatchVO.showCountyNames)&&a.open({template:"/view/goods/supply/supplyOfferRankDialog.html",controller:"supplyOfferRankDialogCrt",resolve:{getData:function(){return{itemId:t.data.supplyBatchVO.itemVO.id,logisticTemplateId:t.data.supplyBatchVO.logisticTemplateId,provinceIdList:t.data.supplyBatchVO.areaVO.provinceAreaIdList,supplyBatchSpecFormList:t.data.supplyBatchVO.supplyBatchSpecVoList}},viewData:function(){return{specName:t.data.supplyBatchVO.itemSpecName,showCountyNames:t.data.supplyBatchVO.showCountyNames,showSize:t.data.supplyBatchVO.showSize}}}})}})}),e.viewFreightTemplate=function(e){a.open({template:"/view/goods/supply/viewFreightTemplateDialog.html",controller:"viewFreightTemplateDialogCtr",width:900,resolve:{getData:function(){return{templateId:e}}}})}}]),app.controller("supplySupplyListCrt",["$scope","$rootScope","ngDialog","confirmFactory","messageFactory","supplyListCacheFactory","supplyService",function(e,t,a,i,o,s,l){function r(t){e.getData.batchStatus=t,e.gridOptions.search()}e.tab=s.listTab,e.tabSelectId=e.tab[0].id,e.getData={batchStatus:e.tab[0].batchStatus,isPause:e.tab[0].isPause},e.listSticTemplateData=[],e.gridOptions={url:"/seller/supplyBatch/querySupplyBatchList.json",columnDefs:s.listTableHeader,params:e.getData,selectAll:!1},e.navTab=function(t){e.tabSelectId=t.id,e.getData.batchStatus=t.batchStatus,e.getData.isPause=t.isPause,e.gridOptions.refresh()},e.sale=function(e){l.sale({batchId:e},function(e){r(e.data.batchStatus)})},e.halt=function(e){i({title:"确定操作",text:"确定操作吗?",ok:function(){l.halt({batchId:e},function(e){r(e.data.batchStatus),o({text:"操作成功！"})})}})},e["delete"]=function(t,i){var o=e;a.open({template:"/view/goods/supply/supplyDeleteDialog.html",width:300,controller:function(e){e.getData={reason:1,batchId:t},e.submit=function(){l.listDelete(e.getData,function(t){o.gridOptions.data.splice(i,1),o=null,e.closeThisDialog()})}}})},e.search=function(){e.gridOptions.search()},l.listSticTemplate(function(t){e.listSticTemplateData=t.data.logisticTemplateVOList})}]),app.controller("supplyOfferInfoDialogCrt",["$scope","supplyService","getData","viewData",function(e,t,a,i){e.viewData=i,e.getData=a,e.load=function(){t.offerInfo(e.getData,function(t){e.infoData=[],e.infoData=t.data})},e.load()}]),app.controller("supplyOfferRankDialogCrt",["$scope","supplyService","getData","viewData",function(e,t,a,i){e.viewData=i,e.offerRankData=[],a.areaIdSize=i.showCountyNames.match(/[1-9][0-9]*/g)[0],t.offerRank(a,function(t){e.offerRankData=t.data})}]),app.controller("viewFreightTemplateDialogCtr",["$scope","supplyService","freightTemplateFactory","freightTemplateService","getData",function(e,t,a,i,o){e.tabData=a.editTab,e.viewData={},e.selectId=1,e.tabToggle=function(t){e.selectId=t},i.getTemplate(o,function(t){e.viewData=t.data,e.tabToggle(t.data.logisticType.split(",")[0])})}]),app.factory("supplyListCacheFactory",function(){return{listTab:[{name:"所有",batchStatus:0,isPause:0},{id:1,name:"待出售",batchStatus:1,isPause:0},{id:2,name:"出售中",batchStatus:2,isPause:0},{id:3,name:"停售中",batchStatus:2,isPause:1}],listTableHeader:[{displayName:"商品",field:"itemName",width:"16%"},{displayName:"批次编号",field:"batchNo",width:"10%"},{displayName:"规格/价格/毛重(kg)/体积(m³)",width:"8%",cellTemplate:'<div class="lh-20"><p ng-repeat="item in row.supplyBatchSpecVoList track by $index">{{::item.specNum}}{{::row.itemSpecName}}/¥{{::item.price}}/{{::item.roughWeight}}/{{::item.packBulk}}</p></div>'},{displayName:"批次库存",field:"currentStock",width:"7%"},{displayName:"上架有效期",width:"10%",cellTemplate:"<div>{{::row.validTime}}-{{::row.expireTime}}</div>"},{displayName:"生产日期",field:"productionTime",width:"8%"},{displayName:"运费模板",field:"logisticTemplateName",width:"8%"},{displayName:"状态",width:"8%",cellTemplate:"<div class=\"{{row.batchStatus == 2 ? 'halt' : 'sell'}}\">{{row.batchStatusDesc}}</div>"},{displayName:"创建时间",field:"createTime",width:"15%"},{displayName:"操作",field:"title9",width:"9%",cellTemplate:'<div class="operation"><a ng-click="evt.entity.halt(row.id)" ng-if="row.batchStatus === 2 && !row.isPause">停售</a><a ng-click="evt.entity.sale(row.id)" ng-if="row.batchStatus === 3 || row.batchStatus === 2 && row.isPause">销售</a><a ng-click="evt.entity.delete(row.id,$index)" ng-if="row.batchStatus != 4">人工销毁</a><a href="{{parfix}}goods/supplyDetailInfo.do?id={{row.id}}" target="_blank">查看</a><a href="{{parfix}}goods/supplyDetailEdit.do?type=copy&id={{row.id}}">复制</a><a href="{{parfix}}goods/supplyDetailEdit.do?type=edit&id={{row.id}}" ng-if="row.batchStatus != 4">修改</a></div>'}]}}),app.service("supplyService",["$http",function(e){this.sale=function(t,a){e.post("/seller/supplyBatch/startSupplyBatch.json ",t).success(a)},this.halt=function(t,a){e.post("/seller/supplyBatch/pauseSupplyBatch.json ",t).success(a)},this.listDelete=function(t,a){e.post("/seller/supplyBatch/destroySupplyBatch.json ",t).success(a)},this.listSticTemplate=function(t){e.get("/seller/supplyBatch/queryLogisticTemplate.json").success(t)},this.detailData=function(t,a){e.get("/seller/supplyBatch/querySupplyBatchDetail.json ",{params:t}).success(a)},this.shopTypeData=function(t){e.get("/seller/supplyBatch/queryFirstCategory.json").success(t)},this.offerRank=function(t,a){e.post("/seller/supplyBatch/sortSupplyBatchListByPrice.json",t).success(a)},this.offerInfo=function(t,a){e.post("/seller/supplyBatch/querySupplyBatchListByPrice.json",t).success(a)},this.offerInfo=function(t,a){e.post("/seller/supplyBatch/querySupplyBatchListByPrice.json",t).success(a)},this.updateSupplyBatch=function(t,a){e.post("/seller/supplyBatch/updateSupplyBatchById.json",t).success(a)},this.addSupplyBatch=function(t,a){e.post("/seller/supplyBatch/saveSupplyBatchById.json",t).success(a)},this.queryItemByCategory=function(t,a){e.post("/seller/supplyBatch/queryItemByCategoryId.json",t).success(a)},this.queryProvince=function(t,a){e.post("/seller/supplyBatch/queryProvinceByIds.json",t).success(a)},this.queryTemplate=function(t,a){e.post("/seller/supplyBatch/queryLogisticTemplateById.json",t).success(a)}}]),app.controller("orderDeliverDialogCrt",["$scope","$rootScope","$state","orderCacheFactory","orderListService","rowData",function(e,t,a,i,o,s){e.rowItemData=s,e.logisticsName=i.logisticsName,e.getData={logisticsType:s.logisticsVO.logisticsType,logisticsTelephone:s.logisticsVO.logisticsTelephone,logisticsAddress:s.logisticsVO.logisticsAddress},e.submit=function(){e.getData.orderId=s.id,e.getData.orderNum=s.orderNum,o.delivery(e.getData,function(t){a.go("order/orderList.type",{type:"dDelivered"}),e.closeThisDialog()})}}]),app.controller("orderListBaseCrt",["$scope","$rootScope","$state","orderCacheFactory",function(e,t,a,i){e.listNavTabData=i.listNavTabData,e.navTabSelectItem=e.listNavTabData[a.params.type],e.navTabSelectKey="",e.printData={},e.getListSearchData={},e.navTab=function(t,i){e.navTabSelectItem=i,e.navTabSelectKey=t,a.go("order/orderList.type",{type:t})},e.orderSearchList=function(){e.$broadcast("orderSearchList")},e.exportOrderClick=function(){var t=angular.extend({osdId:e.navTabSelectItem.id},e.getListSearchData);location.href="/seller/order/exportOrder.json?"+angular.param(t)},e.clearDate=function(){e.getListSearchData.orderStartTimeStr="",e.getListSearchData.orderEndTimeStr=""},e.$on("printData",function(t,a){e.printData=a}),e.$on("listNavTabDataChange",function(t,i){var i=i||a.params.type;e.navTab(i,e.listNavTabData[i])})}]),app.controller("orderListCrt",["$scope","$rootScope","$state","messageFactory","orderCacheFactory","orderListService","ngDialog",function(e,t,a,i,o,s,l){function r(){n=[],e.getListData={osdId:e.navTabSelectItem.id,pageNo:1,pageSize:10},angular.extend(e.getListData,e.getListSearchData)}function c(){s.list(e.getListData,function(t){e.orderGridData=t})}var n=[];e.orderGridData={},e.logisticsTypeInit=function(e){e.logisticsTypeName||(e.logisticsTypeName="快递",e.logisticsType=1)},e.delivery=function(e){l.open({template:"/view/order/orderList/orderDeliveryDialog.html",controller:"orderDeliverDialogCrt",resolve:{rowData:function(){return e}}})},e.allBulkExport=function(){var e=n.toString();s.allBulkExport({orderIdList:e},function(e){i({text:"批量受理成功"}),a.go("order/orderList.type",{type:"cAccept"})})},e.bulkExportSelected=function(e){angular.addEditSelect(n,e.id)},e.print=function(t){e.$emit("printData",t)},e.foo=function(t){e.getListData.pageNo=t,c()},e.$emit("listNavTabDataChange",a.params.type),e.$on("orderSearchList",function(e){r(),c()}),r(),c()}]),app.factory("orderCacheFactory",["$rootScope","$sce",function(e,t){return{orderHeader:function(e){},listNavTabData:{all:{name:"全部"},bPaid:{id:6,name:"已支付"},cAccept:{id:16,name:"已受理"},dDelivered:{id:10,name:"已发货"},eComplete:{id:2,name:"已完成"}},logisticsName:["快递","中通速递","圆通速递","邮政小包","申通速递","国通速递","韵达速递","汇通快运","顺丰速递","天天速递","EMS国际","如风达速递","全峰速运","优速快递","百世快运","盛辉物流","安能物流","运通快递","百世快递"]}}]),app.service("orderListService",["$http",function(e){this.list=function(t,a){e.get("/seller/order/queryOrderList.json",{params:t}).success(a)},this.allBulkExport=function(t,a){e.post("/seller/order/bulkOrderPayToAcceptByOrderId.json",t).success(a)},this.delivery=function(t,a){e.post("/seller/order/bulkOrderAcceptToClosedByOrderId.json",t).success(a)},this.orderSearchList=function(t,a){e.post("/seller/order/queryOrderList.json",t).success(a)},this.exportOrder=function(t,a){e.post("/seller/order/exportOrder.json",t).success(a)}}]),app.controller("demoCtr",["$scope","$rootScope","$timeout",function(e,t,a){e.treeList=[{id:1,title:"node1",items:[{id:11,title:"node1.1",nodes:[{id:111,title:"node1.1.1",nodes:[]}]},{id:12,title:"node1.2"}]},{id:2,title:"node2",nodrop:!0,items:[{id:21,title:"node2.1"},{id:3,title:"node3",nodes:[{id:31,title:"node3.1"}]},{id:22,title:"node2.2"}]}],e.autocomplete=[{text:"just"},{text:"some"},{text:"cool"},{text:"tags"}],e.loadTags=function(e){}}]);